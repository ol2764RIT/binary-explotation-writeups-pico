# Basic-File-Exploit-Medium Writeup

**Flag**: `picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_1B9F5942}`

## Summary

The binary functions as a simple echo program with a menu interface to store and retrieve user input. However, the `data_read()` function has an unchecked `strtol()` conversion, where providing an invalid (non-numeric) input like `"0x0"` bypasses the normal logic and **immediately prints the flag** stored in a static global variable. The vulnerability is due to implicit trust in `strtol()` returning zero for both a legitimate `0` input and invalid input, without checking for conversion success.

## Exploit Strategy

* Binary prompts for three choices: store input (`1`), read input (`2`), or exit (`3`).
* On choosing `2`, the program asks for the entry number, converting the input using `strtol()`.
* If the result of `strtol()` is `0`, the flag is printed unconditionally.
* **Key flaw**: If the input is *not* a valid number (e.g., `"0x0"` or `"a"`), `strtol()` returns `0`, and **the flag is printed without any valid index check**.
* Normally, `"0"` would be a valid index input that fails the check, but something like `"0x0"` or `"abc"` triggers the flag leak due to the fallback behavior of `strtol()`.

## Key Points

* **Vulnerability**: `strtol(entry, NULL, 10)` returns `0` on failure to parse, but this is not distinguished from the legitimate input of `0`.
* Inputting an invalid string like `"0x0"` results in the program calling `puts(flag)` and exiting.
* **No need for buffer overflow or format string abuse**, this is a pure logic flaw.
* The flag is stored in a static global: `static const char* flag = "[REDACTED]";`.
* The real flag is revealed when an invalid index is given to the read function.

## TL;DR Exploit Steps

1. Connect to the remote challenge:

   ```
   nc saturn.picoctf.net 52463
   ```
2. Choose option `2` to read an entry.
3. When prompted for an entry number, input:

   ```
   0x0
   ```
4. The flag is printed immediately:

   ```
   picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_1B9F5942}
   ```
